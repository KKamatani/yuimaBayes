% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/bayes.R
\docType{methods}
\name{bayes}
\alias{bayes}
\alias{bayes,yuima-method}
\title{Adaptive Bayesian estimation for \pkg{yuima} objects}
\usage{
\S4method{bayes}{yuima}(
  object,
  chains = 4,
  iter = 2000,
  bounds = list(),
  priors = list(),
  default_prior = "normal(0, 5)",
  ...
)
}
\arguments{
\item{object}{A \code{yuima} object containing model + data.}

\item{chains}{Number of MCMC chains (forwarded to Stan). Default \code{4}.}

\item{iter}{Number of iterations \emph{per chain}. Default \code{2000}.}

\item{bounds}{Named list like \code{list(sigma = c(0, Inf), rho = c(-1, 1))}
giving \eqn{(\mathrm{lower},\,\mathrm{upper})} for any subset
of parameters. Use \code{Inf}, \code{-Inf}, or \code{NULL}
for “no bound”.}

\item{priors}{Named list mapping parameter names to a Stan distribution
string (no semicolon). Use \code{FALSE} or \code{NULL} for a
specific parameter to suppress its prior even if
\code{default_prior} is set.}

\item{default_prior}{Single distribution string applied to all parameters not
listed in \code{priors}. Default \code{"normal(0, 5)"}.
Set \code{NULL} to apply no default prior.}

\item{...}{Further arguments passed to \code{\link[rstan]{sampling}}.}
}
\value{
An S4 object of class \code{"bayes.yuima"} with slots:
\itemize{
\item \code{fit}: the fitted Stan object returned by \code{rstan::sampling()}.
\item \code{call}: the original function call.
\item \code{yuima}: the input \code{yuima} object.
}
}
\description{
Generates Stan code on-the-fly and performs Bayesian inference for
(possibly multivariate) stochastic differential equations stored in a
\pkg{yuima} object.
Each model parameter is declared individually in Stan, so posterior draws
keep their symbolic names.
}
\details{
The function parses the drift and diffusion specified in \code{object@model}
and builds a Gaussian Euler-type one–step transition.
It auto-generates a Stan program with one \emph{unconstrained} (by default)
parameter per model symbol, optionally applying Stan bounds when requested
via \code{bounds}. Any parameters not listed in \code{bounds} remain
unconstrained.
}
\section{Parameter bounds}{

Supply \code{bounds} as a named list such as
\code{list(sigma = c(0, Inf), rho = c(-1, 1))}. Each entry is interpreted as
\eqn{(\mathrm{lower}, \mathrm{upper})}. Use \code{Inf}, \code{-Inf}, or
\code{NULL} for “no bound” on that side. Bounds are translated into Stan
constraints, e.g. \code{real<lower=0>} or \code{real<lower=0, upper=1>}.
}

\section{Priors}{

You may pass \code{priors} as a named list mapping parameter names to a Stan
distribution string (without the trailing semicolon), e.g.
\code{list(sigma = "student_t(3, 0, 0.5)", rho = "uniform(-1, 1)")}.
Any parameter not listed in \code{priors} receives \code{default_prior}.
Set \code{default_prior = NULL} to omit priors entirely (i.e., use only the
likelihood with Stan bounds as constraints).
}

\examples{
\donttest{
if (requireNamespace("yuima", quietly = TRUE) &&
    requireNamespace("rstan",  quietly = TRUE)) {
  library(yuima)

  ## 1D OU model
  mod <- setModel(
    drift          = "theta * (mu - x)",
    diffusion      = "sigma",
    time.variable  = "t",
    state.variable = "x",
    solve.variable = "x"
  )

  set.seed(1)
  samp <- setSampling(Initial = 0, n = 200, delta = 0.01)
  yui  <- setYuima(model = mod, sampling = samp)
  sim  <- simulate(yui, xinit = 0,
                   true.parameter = list(theta = 1, mu = 0, sigma = 0.3))

  # Fast, stable example: weakly-informative priors + adapt_delta
  fit <- bayes(
    sim,
    bounds        = list(sigma = c(0, Inf)),
    priors        = list(sigma = "student_t(3, 0, 0.5)"),
    default_prior = "student_t(3, 0, 2.5)",
    chains        = 2,
    iter          = 800,
    control       = list(adapt_delta = 0.95)
  )

  print(fit@fit)
}
}

\dontrun{
# Custom priors (heavier; not run on CRAN and not by --run-donttest):
fit2 <- bayes(
  sim,
  bounds        = list(sigma = c(0, Inf)),
  priors        = list(
    sigma = "student_t(3, 0, 0.5)",
    theta = "normal(0, 3)",  # slightly tighter than default
    mu    = "normal(0, 3)"
  ),
  default_prior = "student_t(3, 0, 2.5)",
  chains        = 2,
  iter          = 1000,
  control       = list(adapt_delta = 0.98)
)

# Likelihood-dominant (no priors): may need higher adapt_delta and more iters
fit3 <- bayes(sim, default_prior = NULL,
              chains = 2, iter = 1200,
              control = list(adapt_delta = 0.99))
}

}
\seealso{
\pkg{yuima};
\code{\link[yuima:setModel]{setModel}},
\code{\link[yuima:setYuima]{setYuima}},
\code{\link[yuima:simulate]{simulate}};
\code{\link[zoo:index]{index}};
\code{\link[rstan]{sampling}}, \code{\link[rstan]{stan_model}}
}
